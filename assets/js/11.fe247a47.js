(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{468:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"flyway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flyway"}},[t._v("#")]),t._v(" Flyway")]),t._v(" "),s("blockquote",[s("p",[t._v("Flyway æ˜¯ä¸€ä¸ªæ•°æ®è¿ç§»å·¥å…·ã€‚")]),t._v(" "),s("p",[t._v("å…³é”®è¯ï¼š")])]),t._v(" "),s("h2",{attrs:{id:"ç®€ä»‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹"}},[t._v("#")]),t._v(" ç®€ä»‹")]),t._v(" "),s("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯-flyway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯-flyway"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯ Flyway")]),t._v(" "),s("p",[s("strong",[t._v("Flyway æ˜¯ä¸€ä¸ªå¼€æºçš„æ•°æ®åº“è¿ç§»å·¥å…·ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®è¿ç§»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®è¿ç§»"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®è¿ç§»")]),t._v(" "),s("p",[t._v("ä¸ºäº†è¯´æ˜æ•°æ®è¿ç§»çš„ä½œç”¨ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªç¤ºä¾‹ï¼š")]),t._v(" "),s("p",[t._v("ï¼ˆ1ï¼‰å‡è®¾ï¼Œæœ‰ä¸€ä¸ªå«åš Shiny çš„é¡¹ç›®ï¼Œå®ƒçš„æ¶æ„æ˜¯ä¸€ä¸ªå«åš Shiny Soft çš„ App è¿æ¥å«åš Shiny DB çš„æ•°æ®åº“ã€‚")]),t._v(" "),s("p",[t._v("ï¼ˆ2ï¼‰å¯¹äºå¤§å¤šæ•°é¡¹ç›®è€Œè¨€ï¼Œæœ€ç®€å•çš„æŒç»­é›†æˆåœºæ™¯å¦‚ä¸‹æ‰€ç¤ºï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://flywaydb.org/assets/balsamiq/Environments.png",alt:"img"}})]),t._v(" "),s("p",[t._v("è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬ä¸ä»…ä»…è¦å¤„ç†ä¸€ä»½ç¯å¢ƒä¸­çš„ä¿®æ”¹ï¼Œç”±æ­¤ä¼šå¼•å…¥ä¸€äº›ç‰ˆæœ¬å†²çªé—®é¢˜ï¼š")]),t._v(" "),s("p",[t._v("åœ¨ä»£ç ä¾§ï¼ˆå³åº”ç”¨è½¯ä»¶ï¼‰çš„ç‰ˆæœ¬é—®é¢˜æ¯”è¾ƒå®¹æ˜“è§£å†³ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æœ‰æ–¹ä¾¿çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·")]),t._v(" "),s("li",[t._v("æœ‰å¯å¤ç”¨çš„æ„å»ºå’ŒæŒç»­é›†æˆ")]),t._v(" "),s("li",[t._v("è§„èŒƒçš„å‘å¸ƒå’Œéƒ¨ç½²è¿‡ç¨‹")])]),t._v(" "),s("p",[t._v("é‚£ä¹ˆï¼Œæ•°æ®åº“å±‚é¢çš„ç‰ˆæœ¬é—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("ç›®å‰ä»ç„¶æ²¡æœ‰æ–¹ä¾¿çš„æ•°æ®åº“ç‰ˆæœ¬å·¥å…·ã€‚è®¸å¤šé¡¹ç›®ä»ä½¿ç”¨ sql è„šæœ¬æ¥è§£å†³ç‰ˆæœ¬å†²çªï¼Œç”šè‡³æ˜¯é‡åˆ°å†²çªé—®é¢˜æ—¶æ‰æƒ³èµ·ç”¨ sql è¯­å¥å»è§£å†³ã€‚")]),t._v(" "),s("p",[t._v("ç”±æ­¤ï¼Œå¼•å‘ä¸€äº›é—®é¢˜ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æœºå™¨ä¸Šçš„æ•°æ®åº“æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Ÿ")]),t._v(" "),s("li",[t._v("è„šæœ¬åˆ°åº•ç”Ÿæ•ˆæ²¡æœ‰ï¼Ÿ")]),t._v(" "),s("li",[t._v("ç”Ÿäº§ç¯å¢ƒä¿®å¤çš„é—®é¢˜æ˜¯å¦ä¹Ÿåœ¨æµ‹è¯•ç¯å¢ƒä¿®å¤äº†ï¼Ÿ")]),t._v(" "),s("li",[t._v("å¦‚ä½•å»ºç«‹ä¸€ä¸ªæ–°çš„æ•°æ®åº“å®ä¾‹ï¼Ÿ")])]),t._v(" "),s("p",[t._v("æ•°æ®è¿ç§»å°±æ˜¯ç”¨æ¥æå®šè¿™äº›æ··ä¹±çš„é—®é¢˜ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("é€šè¿‡è‰ç¨¿é‡å»ºä¸€ä¸ªæ•°æ®åº“ã€‚")]),t._v(" "),s("li",[t._v("åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥æ¸…æ¥šçš„äº†è§£æ•°æ®åº“çš„çŠ¶æ€ã€‚")]),t._v(" "),s("li",[t._v("ä»¥ä¸€ç§æ˜ç¡®çš„æ–¹å¼å°†æ•°æ®åº“ä»å½“å‰ç‰ˆæœ¬è¿ç§»åˆ°ä¸€ä¸ªæ–°ç‰ˆæœ¬ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"flyway-å¦‚ä½•å·¥ä½œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flyway-å¦‚ä½•å·¥ä½œ"}},[t._v("#")]),t._v(" Flyway å¦‚ä½•å·¥ä½œï¼Ÿ")]),t._v(" "),s("p",[t._v("æœ€ç®€å•çš„åœºæ™¯æ˜¯æŒ‡å®š Flyway è¿ç§»åˆ°ä¸€ä¸ªç©ºçš„æ•°æ®åº“ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-bb6e9f39e56ebbda.png",alt:"img"}})]),t._v(" "),s("p",[t._v("Flyway ä¼šå°è¯•æŸ¥æ‰¾å®ƒçš„ schema å†å²è¡¨ï¼Œå¦‚æœæ•°æ®åº“æ˜¯ç©ºçš„ï¼ŒFlyway å°±ä¸å†æŸ¥æ‰¾ï¼Œè€Œæ˜¯ç›´æ¥åˆ›å»ºæ•°æ®åº“ã€‚")]),t._v(" "),s("p",[t._v("ç°å†ä½ å°±æœ‰äº†ä¸€ä¸ªä»…åŒ…å«ä¸€å¼ ç©ºè¡¨çš„æ•°æ®åº“ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™å¼ è¡¨å« "),s("strong",[t._v("flyway_schema_history")]),t._v("ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-410eb31c6313b389.png",alt:"img"}})]),t._v(" "),s("p",[t._v("è¿™å¼ è¡¨å°†è¢«ç”¨äºè¿½è¸ªæ•°æ®åº“çš„çŠ¶æ€ã€‚")]),t._v(" "),s("p",[t._v("ç„¶åï¼ŒFlyway å°†å¼€å§‹æ‰«ææ–‡ä»¶ç³»ç»Ÿæˆ–åº”ç”¨ classpath ä¸­çš„ "),s("strong",[t._v("migrations")]),t._v("ã€‚è¿™äº› "),s("strong",[t._v("migrations")]),t._v(" å¯ä»¥æ˜¯ sql æˆ– javaã€‚")]),t._v(" "),s("p",[t._v("è¿™äº› "),s("strong",[t._v("migrations")]),t._v(" å°†æ ¹æ®ä»–ä»¬çš„ç‰ˆæœ¬å·è¿›è¡Œæ’åºã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-d36ee07ada4efbcd.png",alt:"img"}})]),t._v(" "),s("p",[t._v("ä»»æ„ migration åº”ç”¨åï¼Œschema å†å²è¡¨å°†æ›´æ–°ã€‚å½“å…ƒæ•°æ®å’Œåˆå§‹çŠ¶æ€æ›¿æ¢åï¼Œå¯ä»¥ç§°ä¹‹ä¸ºï¼šè¿ç§»åˆ°æ–°ç‰ˆæœ¬ã€‚")]),t._v(" "),s("p",[t._v("Flyway ä¸€æ—¦æ‰«æäº†æ–‡ä»¶ç³»ç»Ÿæˆ–åº”ç”¨ classpath ä¸‹çš„ migrationsï¼Œè¿™äº› migrations ä¼šæ£€æŸ¥ schema å†å²è¡¨ã€‚å¦‚æœå®ƒä»¬çš„ç‰ˆæœ¬å·ä½äºæˆ–ç­‰äºå½“å‰çš„ç‰ˆæœ¬ï¼Œå°†è¢«å¿½ç•¥ã€‚ä¿ç•™ä¸‹æ¥çš„ migrations æ˜¯ç­‰å¾…çš„ migrationsï¼Œæœ‰æ•ˆä½†æ²¡æœ‰åº”ç”¨ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-99a88fea7a31a070.png",alt:"img"}})]),t._v(" "),s("p",[t._v("migrations å°†æ ¹æ®ç‰ˆæœ¬å·æ’åºå¹¶æŒ‰åºæ‰§è¡Œã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-b444fef6e5c13b71.png",alt:"img"}})]),t._v(" "),s("h2",{attrs:{id:"å¿«é€Ÿä¸Šæ‰‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¿«é€Ÿä¸Šæ‰‹"}},[t._v("#")]),t._v(" å¿«é€Ÿä¸Šæ‰‹")]),t._v(" "),s("p",[t._v("Flyway æœ‰ 4 ç§ä½¿ç”¨æ–¹å¼ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å‘½ä»¤è¡Œ")]),t._v(" "),s("li",[t._v("JAVA API")]),t._v(" "),s("li",[t._v("Maven")]),t._v(" "),s("li",[t._v("Gradle")])]),t._v(" "),s("h3",{attrs:{id:"å‘½ä»¤è¡Œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‘½ä»¤è¡Œ"}},[t._v("#")]),t._v(" å‘½ä»¤è¡Œ")]),t._v(" "),s("p",[t._v("é€‚ç”¨äºé Java ç”¨æˆ·ï¼Œæ— éœ€æ„å»ºã€‚")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" flyway migrate -url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". -user"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". -password"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),s("p",[t._v("ï¼ˆ1ï¼‰"),s("strong",[t._v("ä¸‹è½½è§£å‹")])]),t._v(" "),s("p",[t._v("è¿›å…¥"),s("a",{attrs:{href:"https://flywaydb.org/download/",target:"_blank",rel:"noopener noreferrer"}},[t._v("å®˜æ–¹ä¸‹è½½é¡µé¢"),s("OutboundLink")],1),t._v("ï¼Œé€‰æ‹©åˆé€‚ç‰ˆæœ¬ï¼Œä¸‹è½½å¹¶è§£å‹åˆ°æœ¬åœ°ã€‚")]),t._v(" "),s("p",[t._v("ï¼ˆ2ï¼‰"),s("strong",[t._v("é…ç½® flyway")])]),t._v(" "),s("p",[t._v("ç¼–è¾‘ "),s("code",[t._v("/conf/flyway.conf")]),t._v("ï¼š")]),t._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("flyway.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("jdbc:h2:file:./foobardb")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("flyway.user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("SA")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("flyway.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n")])])]),s("p",[t._v("ï¼ˆ3ï¼‰"),s("strong",[t._v("åˆ›å»ºç¬¬ä¸€ä¸ª migration")])]),t._v(" "),s("p",[t._v("åœ¨ "),s("code",[t._v("/sql")]),t._v(" ç›®å½•ä¸‹åˆ›å»º "),s("code",[t._v("V1__Create_person_table.sql")]),t._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    ID "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    NAME "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("ï¼ˆ4ï¼‰"),s("strong",[t._v("è¿ç§»æ•°æ®åº“")])]),t._v(" "),s("p",[t._v("è¿è¡Œ Flyway æ¥è¿ç§»æ•°æ®åº“ï¼š")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("flyway-5.1."),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(" flyway migrate\n")])])]),s("p",[t._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('Database: jdbc:h2:file:./foobardb (H2 1.4)\nSuccessfully validated 1 migration (execution time 00:00.008s)\nCreating Schema History table: "PUBLIC"."flyway_schema_history"\nCurrent version of schema "PUBLIC": << Empty Schema >>\nMigrating schema "PUBLIC" to version 1 - Create person table\nSuccessfully applied 1 migration to schema "PUBLIC" (execution time 00:00.033s)\n')])])]),s("p",[t._v("ï¼ˆ5ï¼‰"),s("strong",[t._v("æ·»åŠ ç¬¬äºŒä¸ª migration")])]),t._v(" "),s("p",[t._v("åœ¨ "),s("code",[t._v("/sql")]),t._v(" ç›®å½•ä¸‹åˆ›å»º "),s("code",[t._v("V2__Add_people.sql")]),t._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Axel'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mr. Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Ms. Bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("è¿è¡Œ Flyway")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("flyway-5.1."),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(" flyway migrate\n")])])]),s("p",[t._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('Database: jdbc:h2:file:./foobardb (H2 1.4)\nSuccessfully validated 2 migrations (execution time 00:00.018s)\nCurrent version of schema "PUBLIC": 1\nMigrating schema "PUBLIC" to version 2 - Add people\nSuccessfully applied 1 migration to schema "PUBLIC" (execution time 00:00.016s)\n')])])]),s("h3",{attrs:{id:"java-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-api"}},[t._v("#")]),t._v(" JAVA API")]),t._v(" "),s("p",[t._v("ï¼ˆ1ï¼‰"),s("strong",[t._v("å‡†å¤‡")])]),t._v(" "),s("ul",[s("li",[t._v("Java8+")]),t._v(" "),s("li",[t._v("Maven 3.x")])]),t._v(" "),s("p",[t._v("ï¼ˆ2ï¼‰"),s("strong",[t._v("æ·»åŠ ä¾èµ–")])]),t._v(" "),s("p",[t._v("åœ¨ "),s("code",[t._v("pom.xml")]),t._v(" ä¸­æ·»åŠ ä¾èµ–ï¼š")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("project")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    ...\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.flywaydb"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("flyway-core"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("5.1.4"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.h2database"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("h2"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.3.170"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        ...\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    ...\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("project")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("ï¼ˆ3ï¼‰"),s("strong",[t._v("é›†æˆ Flyway")])]),t._v(" "),s("p",[t._v("æ·»åŠ  "),s("code",[t._v("App.java")]),t._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flywaydb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flyway")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("App")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create the Flyway instance")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flyway")]),t._v(" flyway "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flyway")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Point it to the database")]),t._v("\n        flyway"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setDataSource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jdbc:h2:file:./target/foobar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sa"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Start the migration")]),t._v("\n        flyway"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("migrate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("ï¼ˆ4ï¼‰"),s("strong",[t._v("åˆ›å»ºç¬¬ä¸€ä¸ª migration")])]),t._v(" "),s("p",[t._v("æ·»åŠ  "),s("code",[t._v("src/main/resources/db/migration/V1__Create_person_table.sql")]),t._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    ID "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    NAME "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("ï¼ˆ5ï¼‰"),s("strong",[t._v("æ‰§è¡Œç¨‹åº")])]),t._v(" "),s("p",[t._v("æ‰§è¡Œ "),s("code",[t._v("App#main")]),t._v("ï¼š")]),t._v(" "),s("p",[t._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('INFO: Creating schema history table: "PUBLIC"."flyway_schema_history"\nINFO: Current version of schema "PUBLIC": << Empty Schema >>\nINFO: Migrating schema "PUBLIC" to version 1 - Create person table\nINFO: Successfully applied 1 migration to schema "PUBLIC" (execution time 00:00.062s).\n')])])]),s("p",[t._v("ï¼ˆ6ï¼‰"),s("strong",[t._v("æ·»åŠ ç¬¬äºŒä¸ª migration")])]),t._v(" "),s("p",[t._v("æ·»åŠ  src/main/resources/db/migration/V2__Add_people.sql æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Axel'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mr. Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Ms. Bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('INFO: Current version of schema "PUBLIC": 1\nINFO: Migrating schema "PUBLIC" to version 2 - Add people\nINFO: Successfully applied 1 migration to schema "PUBLIC" (execution time 00:00.090s).\n')])])]),s("h3",{attrs:{id:"maven"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#maven"}},[t._v("#")]),t._v(" Maven")]),t._v(" "),s("p",[t._v("ä¸ Java API æ–¹å¼å¤§ä½“ç›¸åŒï¼ŒåŒºåˆ«åœ¨ "),s("strong",[t._v("é›†æˆ Flyway")]),t._v(" æ­¥éª¤ï¼š")]),t._v(" "),s("p",[t._v("Maven æ–¹å¼ä½¿ç”¨æ’ä»¶æ¥é›†æˆ Flywayï¼š")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("project")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("xmlns")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("..."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    ...\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugins")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.flywaydb"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("flyway-maven-plugin"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("5.1.4"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("jdbc:h2:file:./target/foobar"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("sa"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.h2database"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("h2"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.4.191"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugins")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("project")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("å› ä¸ºç”¨çš„æ˜¯æ’ä»¶ï¼Œæ‰€ä»¥æ‰§è¡Œæ–¹å¼ä¸å†æ˜¯è¿è¡Œ Java ç±»ï¼Œè€Œæ˜¯æ‰§è¡Œ maven æ’ä»¶ï¼š")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" mvn flyway:migrate\n")])])]),s("blockquote",[s("p",[t._v("ğŸ‘‰ å‚è€ƒï¼š"),s("a",{attrs:{href:"https://github.com/dunwu/Database/tree/master/codes/middleware/flyway",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç¤ºä¾‹æºç "),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"gradle"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gradle"}},[t._v("#")]),t._v(" Gradle")]),t._v(" "),s("p",[t._v("æœ¬äººä¸ç”¨ Gradleï¼Œç•¥ã€‚")]),t._v(" "),s("h2",{attrs:{id:"å…¥é—¨ç¯‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…¥é—¨ç¯‡"}},[t._v("#")]),t._v(" å…¥é—¨ç¯‡")]),t._v(" "),s("h3",{attrs:{id:"æ¦‚å¿µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚å¿µ"}},[t._v("#")]),t._v(" æ¦‚å¿µ")]),t._v(" "),s("h4",{attrs:{id:"migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#migrations"}},[t._v("#")]),t._v(" Migrations")]),t._v(" "),s("p",[t._v("åœ¨ Flyway ä¸­ï¼Œå¯¹äºæ•°æ®åº“çš„ä»»ä½•æ”¹å˜éƒ½ç§°ä¹‹ä¸º "),s("strong",[t._v("Migrations")]),t._v("ã€‚")]),t._v(" "),s("p",[t._v("Migrations å¯ä»¥åˆ†ä¸º Versioned migrations å’Œ Repeatable migrationsã€‚")]),t._v(" "),s("p",[t._v("Versioned migrations æœ‰ 2 ç§å½¢å¼ï¼šregular å’Œ undoã€‚")]),t._v(" "),s("p",[t._v("Versioned migrations å’Œ Repeatable migrations éƒ½å¯ä»¥ä½¿ç”¨ SQL æˆ– JAVA æ¥ç¼–å†™ã€‚")]),t._v(" "),s("h5",{attrs:{id:"versioned-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#versioned-migrations"}},[t._v("#")]),t._v(" Versioned migrations")]),t._v(" "),s("p",[t._v("ç”±ä¸€ä¸ªç‰ˆæœ¬å·ï¼ˆversionï¼‰ã€ä¸€æ®µæè¿°ï¼ˆdescriptionï¼‰ã€ä¸€ä¸ªæ ¡éªŒï¼ˆchecksumï¼‰ç»„æˆã€‚ç‰ˆæœ¬å·å¿…é¡»æ˜¯æƒŸä¸€çš„ã€‚Versioned migrations åªèƒ½æŒ‰é¡ºåºæ‰§è¡Œä¸€æ¬¡ã€‚")]),t._v(" "),s("p",[t._v("ä¸€èˆ¬ç”¨äºï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¢åˆ æ”¹ tables/indexes/foreign keys/enums/UDTsã€‚")]),t._v(" "),s("li",[t._v("å¼•ç”¨æ•°æ®æ›´æ–°")]),t._v(" "),s("li",[t._v("ç”¨æˆ·æ•°æ®æ ¡æ­£")])]),t._v(" "),s("p",[t._v("Regular ç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" car "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    license_plate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VARCHAR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VARCHAR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" owner "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" driver_license_id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VARCHAR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" brand "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DeLorean'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"undo-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#undo-migrations"}},[t._v("#")]),t._v(" Undo migrations")]),t._v(" "),s("blockquote",[s("p",[t._v("æ³¨ï¼šä»…ä¸“ä¸šç‰ˆæ”¯æŒ")])]),t._v(" "),s("p",[t._v("Undo Versioned Migrations è´Ÿè´£æ’¤é”€ Regular Versioned migrations çš„å½±å“ã€‚")]),t._v(" "),s("p",[t._v("Undo ç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" brand "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DeLorean'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" owner "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" driver_license_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" car"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"repeatable-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#repeatable-migrations"}},[t._v("#")]),t._v(" Repeatable migrations")]),t._v(" "),s("p",[t._v("ç”±ä¸€æ®µæè¿°ï¼ˆdescriptionï¼‰ã€ä¸€ä¸ªæ ¡éªŒï¼ˆchecksumï¼‰ç»„æˆã€‚Versioned migrations æ¯æ¬¡æ‰§è¡Œåï¼Œæ ¡éªŒï¼ˆchecksumï¼‰ä¼šæ›´æ–°ã€‚")]),t._v(" "),s("p",[t._v("Repeatable migrations ç”¨äºç®¡ç†å¯ä»¥é€šè¿‡ä¸€ä¸ªæ–‡ä»¶æ¥ç»´æŠ¤ç‰ˆæœ¬æ§åˆ¶çš„æ•°æ®åº“å¯¹è±¡ã€‚")]),t._v(" "),s("p",[t._v("ä¸€èˆ¬ç”¨äºï¼š")]),t._v(" "),s("ul",[s("li",[t._v("åˆ›å»ºï¼ˆé‡å»ºï¼‰views/procedures/functions/packages ç­‰ã€‚")]),t._v(" "),s("li",[t._v("å¤§é‡å¼•ç”¨æ•°æ®é‡æ–°æ’å…¥")])]),t._v(" "),s("p",[t._v("ç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("OR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("REPLACE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VIEW")]),t._v(" blue_cars "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" license_plate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" cars "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" color"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'blue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h5",{attrs:{id:"åŸºäº-sql-çš„-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäº-sql-çš„-migrations"}},[t._v("#")]),t._v(" åŸºäº SQL çš„ migrations")]),t._v(" "),s("p",[t._v("migrations æœ€å¸¸ç”¨çš„ç¼–å†™å½¢å¼å°±æ˜¯ SQLã€‚")]),t._v(" "),s("p",[t._v("åŸºäº SQL çš„ migrations ä¸€èˆ¬ç”¨äºï¼š")]),t._v(" "),s("ul",[s("li",[t._v("DDL å˜æ›´ï¼ˆé’ˆå¯¹ TABLES,VIEWS,TRIGGERS,SEQUENCES ç­‰çš„ CREATE/ALTER/DROP æ“ä½œï¼‰")]),t._v(" "),s("li",[t._v("ç®€å•çš„å¼•ç”¨æ•°æ®å˜æ›´ï¼ˆå¼•ç”¨æ•°æ®è¡¨ä¸­çš„ CRUDï¼‰")]),t._v(" "),s("li",[t._v("ç®€å•çš„å¤§é‡æ•°æ®å˜æ›´ï¼ˆå¸¸è§„æ•°æ®è¡¨ä¸­çš„ CRUDï¼‰")])]),t._v(" "),s("p",[s("strong",[t._v("å‘½åè§„åˆ™")])]),t._v(" "),s("p",[t._v("ä¸ºäº†è¢« Flyway è‡ªåŠ¨è¯†åˆ«ï¼ŒSQL migrations çš„æ–‡ä»¶å‘½åå¿…é¡»éµå¾ªè§„å®šçš„æ¨¡å¼ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/database/flyway/sql-migrations.png!zp",alt:"img"}})]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Prefix")]),t._v(" - "),s("code",[t._v("V")]),t._v(" ä»£è¡¨ versioned migrations (å¯é…ç½®), "),s("code",[t._v("U")]),t._v(" ä»£è¡¨ undo migrations (å¯é…ç½®)ã€ "),s("code",[t._v("R")]),t._v(" ä»£è¡¨ repeatable migrations (å¯é…ç½®)")]),t._v(" "),s("li",[s("strong",[t._v("Version")]),t._v(" - ç‰ˆæœ¬å·é€šè¿‡"),s("code",[t._v(".")]),t._v("(ç‚¹)æˆ–"),s("code",[t._v("_")]),t._v("(ä¸‹åˆ’çº¿)åˆ†éš” (repeatable migrations ä¸éœ€è¦)")]),t._v(" "),s("li",[s("strong",[t._v("Separator")]),t._v(" - "),s("code",[t._v("__")]),t._v(" (ä¸¤ä¸ªä¸‹åˆ’çº¿) (å¯é…ç½®)")]),t._v(" "),s("li",[s("strong",[t._v("Description")]),t._v(" - ä¸‹åˆ’çº¿æˆ–ç©ºæ ¼åˆ†éš”çš„å•è¯")]),t._v(" "),s("li",[s("strong",[t._v("Suffix")]),t._v(" - "),s("code",[t._v(".sql")]),t._v(" (å¯é…ç½®)")])]),t._v(" "),s("h5",{attrs:{id:"åŸºäº-java-çš„-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäº-java-çš„-migrations"}},[t._v("#")]),t._v(" åŸºäº JAVA çš„ migrations")]),t._v(" "),s("p",[t._v("åŸºäº JAVA çš„ migrations é€‚ç”¨äºä½¿ç”¨ SQL ä¸å®¹æ˜“è¡¨è¾¾çš„åœºæ™¯ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("BLOB å’Œ CLOB å˜æ›´")]),t._v(" "),s("li",[t._v("å¤§é‡æ•°æ®çš„é«˜çº§å˜æ›´ï¼ˆé‡æ–°è®¡ç®—ã€é«˜çº§æ ¼å¼å˜æ›´ï¼‰")])]),t._v(" "),s("p",[s("strong",[t._v("å‘½åè§„åˆ™")])]),t._v(" "),s("p",[t._v("ä¸ºäº†è¢« Flyway è‡ªåŠ¨è¯†åˆ«ï¼ŒJAVA migrations çš„æ–‡ä»¶å‘½åå¿…é¡»éµå¾ªè§„å®šçš„æ¨¡å¼ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/database/flyway/java-migrations.png!zp",alt:"img"}})]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Prefix")]),t._v(" - "),s("code",[t._v("V")]),t._v(" ä»£è¡¨ versioned migrations (å¯é…ç½®), "),s("code",[t._v("U")]),t._v(" ä»£è¡¨ undo migrations (å¯é…ç½®)ã€ "),s("code",[t._v("R")]),t._v(" ä»£è¡¨ repeatable migrations (å¯é…ç½®)")]),t._v(" "),s("li",[s("strong",[t._v("Version")]),t._v(" - ç‰ˆæœ¬å·é€šè¿‡"),s("code",[t._v(".")]),t._v("(ç‚¹)æˆ–"),s("code",[t._v("_")]),t._v("(ä¸‹åˆ’çº¿)åˆ†éš” (repeatable migrations ä¸éœ€è¦)")]),t._v(" "),s("li",[s("strong",[t._v("Separator")]),t._v(" - "),s("code",[t._v("__")]),t._v(" (ä¸¤ä¸ªä¸‹åˆ’çº¿) (å¯é…ç½®)")]),t._v(" "),s("li",[s("strong",[t._v("Description")]),t._v(" - ä¸‹åˆ’çº¿æˆ–ç©ºæ ¼åˆ†éš”çš„å•è¯")])]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ‘‰ æ›´å¤šç»†èŠ‚è¯·å‚è€ƒï¼šhttps://flywaydb.org/documentation/migrations")])]),t._v(" "),s("h4",{attrs:{id:"callbacks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#callbacks"}},[t._v("#")]),t._v(" Callbacks")]),t._v(" "),s("blockquote",[s("p",[t._v("æ³¨ï¼šéƒ¨åˆ† events ä»…ä¸“ä¸šç‰ˆæ”¯æŒã€‚")])]),t._v(" "),s("p",[t._v("å°½ç®¡ Migrations å¯èƒ½å·²ç»æ»¡è¶³ç»å¤§éƒ¨åˆ†åœºæ™¯çš„éœ€è¦ï¼Œä½†æ˜¯æŸäº›æƒ…å†µä¸‹éœ€è¦ä½ ä¸€éåˆä¸€éçš„æ‰§è¡Œç›¸åŒçš„è¡Œä¸ºã€‚è¿™å¯èƒ½ä¼šé‡æ–°ç¼–è¯‘å­˜å‚¨è¿‡ç¨‹ï¼Œæ›´æ–°è§†å›¾ä»¥åŠè®¸å¤šå…¶ä»–ç±»å‹çš„å¼€é”€ã€‚")]),t._v(" "),s("p",[t._v("å› ä¸ºä»¥ä¸ŠåŸå› ï¼ŒFlyway æä¾›äº† Callbacksï¼Œç”¨äºåœ¨ Migrations ç”Ÿå‘½å‘¨æœŸä¸­æ·»åŠ é’©å­ã€‚")]),t._v(" "),s("p",[t._v("Callbacks å¯ä»¥ç”¨ SQL æˆ– JAVA æ¥å®ç°ã€‚")]),t._v(" "),s("h5",{attrs:{id:"sql-callbacks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sql-callbacks"}},[t._v("#")]),t._v(" SQL Callbacks")]),t._v(" "),s("p",[t._v("SQL Callbacks çš„å‘½åè§„åˆ™ä¸ºï¼ševent å + SQL migrationã€‚")]),t._v(" "),s("p",[t._v("å¦‚ï¼š "),s("code",[t._v("beforeMigrate.sql")]),t._v(", "),s("code",[t._v("beforeEachMigrate.sql")]),t._v(", "),s("code",[t._v("afterEachMigrate.sql")]),t._v(" ç­‰ã€‚")]),t._v(" "),s("p",[t._v("SQL Callbacks ä¹Ÿå¯ä»¥åŒ…å«æè¿°ï¼ˆdescriptionï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒSQL Callbacks æ–‡ä»¶å = event å + åˆ†éš”ç¬¦ + æè¿° + åç¼€ã€‚ä¾‹ï¼š"),s("code",[t._v("beforeRepair__vacuum.sql")])]),t._v(" "),s("p",[t._v("å½“åŒä¸€ä¸ª event æœ‰å¤šä¸ª SQL callbacksï¼Œå°†æŒ‰ç…§å®ƒä»¬æè¿°ï¼ˆdescriptionï¼‰çš„é¡ºåºæ‰§è¡Œã€‚")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("æ³¨ï¼š")]),t._v(" Flyway ä¹Ÿæ”¯æŒä½ é…ç½®çš„ "),s("code",[t._v("sqlMigrationSuffixes")]),t._v("ã€‚")])]),t._v(" "),s("h5",{attrs:{id:"java-callbacks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-callbacks"}},[t._v("#")]),t._v(" JAVA Callbacks")]),t._v(" "),s("blockquote",[s("p",[t._v("å½“ SQL Callbacks ä¸å¤Ÿæ–¹ä¾¿æ—¶ï¼Œæ‰åº”è€ƒè™‘ JAVA Callbacksã€‚")])]),t._v(" "),s("p",[t._v("JAVA Callbacks æœ‰ 3 ç§å½¢å¼ï¼š")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("åŸºäº Java çš„ Migrations")]),t._v(" - å®ç° JdbcMigrationã€SpringJdbcMigrationã€MigrationInfoProviderã€MigrationChecksumProviderã€ConfigurationAwareã€FlywayConfiguration")]),t._v(" "),s("li",[s("strong",[t._v("åŸºäº Java çš„ Callbacks")]),t._v(" - å®ç° org.flywaydb.core.api.callback æ¥å£ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è‡ªå®šä¹‰ Migration resolvers å’Œ executors")]),t._v(" - å®ç° MigrationResolverã€MigrationExecutorã€ConfigurationAwareã€FlywayConfiguration æ¥å£ã€‚")])]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ‘‰ æ›´å¤šç»†èŠ‚è¯·å‚è€ƒï¼šhttps://flywaydb.org/documentation/callbacks")])]),t._v(" "),s("h4",{attrs:{id:"error-handlers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-handlers"}},[t._v("#")]),t._v(" Error Handlers")]),t._v(" "),s("blockquote",[s("p",[t._v("æ³¨ï¼šä»…ä¸“ä¸šç‰ˆæ”¯æŒã€‚")])]),t._v(" "),s("p",[t._v("ï¼ˆç•¥ï¼‰")]),t._v(" "),s("h4",{attrs:{id:"dry-runs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dry-runs"}},[t._v("#")]),t._v(" Dry Runs")]),t._v(" "),s("blockquote",[s("p",[t._v("æ³¨ï¼šä»…ä¸“ä¸šç‰ˆæ”¯æŒã€‚")])]),t._v(" "),s("p",[t._v("ï¼ˆç•¥ï¼‰")]),t._v(" "),s("h3",{attrs:{id:"å‘½ä»¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‘½ä»¤"}},[t._v("#")]),t._v(" å‘½ä»¤")]),t._v(" "),s("p",[t._v("Flyway çš„åŠŸèƒ½ä¸»è¦å›´ç»•ç€ 7 ä¸ªåŸºæœ¬å‘½ä»¤ï¼š"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/migrate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Migrate"),s("OutboundLink")],1),t._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/clean",target:"_blank",rel:"noopener noreferrer"}},[t._v("Clean"),s("OutboundLink")],1),t._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/info",target:"_blank",rel:"noopener noreferrer"}},[t._v("Info"),s("OutboundLink")],1),t._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/validate",target:"_blank",rel:"noopener noreferrer"}},[t._v("Validate"),s("OutboundLink")],1),t._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/undo",target:"_blank",rel:"noopener noreferrer"}},[t._v("Undo"),s("OutboundLink")],1),t._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/baseline",target:"_blank",rel:"noopener noreferrer"}},[t._v("Baseline"),s("OutboundLink")],1),t._v(" å’Œ "),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/repair",target:"_blank",rel:"noopener noreferrer"}},[t._v("Repair"),s("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),s("p",[t._v("æ³¨ï¼šå„å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ç»†èŠ‚è¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚")]),t._v(" "),s("h3",{attrs:{id:"æ”¯æŒçš„æ•°æ®åº“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ”¯æŒçš„æ•°æ®åº“"}},[t._v("#")]),t._v(" æ”¯æŒçš„æ•°æ®åº“")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/oracle",target:"_blank",rel:"noopener noreferrer"}},[t._v("Oracle"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/sqlserver",target:"_blank",rel:"noopener noreferrer"}},[t._v("SQL Server"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/db2",target:"_blank",rel:"noopener noreferrer"}},[t._v("DB2"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/mysql",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/mariadb",target:"_blank",rel:"noopener noreferrer"}},[t._v("MariaDB"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/postgresql",target:"_blank",rel:"noopener noreferrer"}},[t._v("PostgreSQL"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/redshift",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redshift"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/cockroachdb",target:"_blank",rel:"noopener noreferrer"}},[t._v("CockroachDB"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/saphana",target:"_blank",rel:"noopener noreferrer"}},[t._v("SAP HANA"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/sybasease",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sybase ASE"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/informix",target:"_blank",rel:"noopener noreferrer"}},[t._v("Informix"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/h2",target:"_blank",rel:"noopener noreferrer"}},[t._v("H2"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/hsqldb",target:"_blank",rel:"noopener noreferrer"}},[t._v("HSQLDB"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/derby",target:"_blank",rel:"noopener noreferrer"}},[t._v("Derby"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/sqlite",target:"_blank",rel:"noopener noreferrer"}},[t._v("SQLite"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"èµ„æ–™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#èµ„æ–™"}},[t._v("#")]),t._v(" èµ„æ–™")]),t._v(" "),s("p",[t._v("| "),s("a",{attrs:{href:"https://github.com/flyway/flyway",target:"_blank",rel:"noopener noreferrer"}},[t._v("Github"),s("OutboundLink")],1),t._v(" | "),s("a",{attrs:{href:"https://flywaydb.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("å®˜æ–¹æ–‡æ¡£"),s("OutboundLink")],1),t._v(" |")]),t._v(" "),s("h2",{attrs:{id:"ä¼ é€é—¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¼ é€é—¨"}},[t._v("#")]),t._v(" ğŸšª ä¼ é€é—¨")]),t._v(" "),s("p",[t._v("| "),s("a",{attrs:{href:"https://github.com/dunwu/blog",target:"_blank",rel:"noopener noreferrer"}},[t._v("æˆ‘çš„ Github åšå®¢"),s("OutboundLink")],1),t._v(" | "),s("a",{attrs:{href:"https://github.com/dunwu/db-tutorial",target:"_blank",rel:"noopener noreferrer"}},[t._v("db-tutorial é¦–é¡µ"),s("OutboundLink")],1),t._v(" |")])])}),[],!1,null,null,null);a.default=e.exports}}]);